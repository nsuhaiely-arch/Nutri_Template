<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nutri Template - Fixed</title>
  <style>
    body { font-family: Inter, system-ui, Arial, sans-serif; margin: 0; padding: 20px; background:#f7fafc; color:#0f172a; }
    .container { max-width: 1100px; margin: 0 auto; }
    h1 { font-size: 28px; margin-bottom: 12px; }
    section { background: #fff; padding: 18px; border-radius: 10px; box-shadow: 0 6px 18px rgba(2,6,23,0.06); margin-bottom: 18px; }
    label { display:block; margin-top:8px; font-weight:600; font-size:13px; }
    input[type="number"], select { width:160px; padding:8px; border-radius:6px; border:1px solid #e6edf3; margin-top:6px; }
    button { padding:8px 12px; border-radius:8px; border:0; background:#0f172a; color:#fff; cursor:pointer; }
    .result { margin-top:12px; font-weight:700; }
    .flex { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    .tabs { display:flex; gap:8px; margin-top:12px; }
    .tab-btn { padding:8px 10px; border-radius:8px; border:1px solid #e6edf3; background:#fff; cursor:pointer; }
    .tab-btn.active { background:#0f172a; color:#a7f3d0; border-color:#10b981; }
    .tab-content { display:none; margin-top:12px; }
    .tab-content.active { display:block; }
    #snack-img { width:100%; max-width:420px; height:220px; object-fit:cover; border-radius:8px; margin-top:12px; }
    /* BMI bar */
    .bmi-bar { position:relative; height:18px; background:#e6edf3; border-radius:999px; margin-top:12px; }
    .bmi-marker { position:absolute; top:-10px; width:6px; height:36px; background:#0f172a; border-radius:4px; transform:translateX(-50%); }
    .bmi-display { font-size:48px; font-weight:900; margin-top:12px; }
    /* Game */
    #game-container { position:relative; width:100%; height:360px; background:linear-gradient(180deg,#ecfeff,#f8fafc); border-radius:10px; overflow:hidden; border:1px solid #e6edf3; }
    #player-paddle { position:absolute; bottom:12px; left:185px; width:80px; height:36px; background:#0f172a; border-radius:8px; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:700; }
    .item-drop { position:absolute; font-size:26px; pointer-events:none; user-select:none; }
    #game-ui { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; gap:12px; flex-direction:column; }
    #score { font-size:20px; font-weight:800; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nutri Template â€” Versi Dibaiki</h1>

    <!-- Water Calculator -->
    <section id="water-section">
      <h2>Water Intake Calculator</h2>
      <div class="flex">
        <div>
          <label for="water-weight">Weight (kg)</label>
          <input type="number" id="water-weight" placeholder="e.g. 70" min="20" />
        </div>
        <div style="align-self:flex-end;">
          <button onclick="calculateWater()">Calculate</button>
        </div>
      </div>
      <div id="result-box" class="result hidden">
        <div><strong id="water-result">0 Litres</strong></div>
        <div>Equivalent glasses (250ml): <strong id="glass-count">0</strong></div>
      </div>
    </section>

    <!-- Snack Tabs -->
    <section>
      <h2>Snack Suggestions</h2>
      <div class="tabs">
        <button id="btn-energy" class="tab-btn" onclick="showSnack('energy')">Energy</button>
        <button id="btn-focus" class="tab-btn" onclick="showSnack('focus')">Focus</button>
        <button id="btn-stress" class="tab-btn" onclick="showSnack('stress')">Stress</button>
        <button id="btn-hunger" class="tab-btn" onclick="showSnack('hunger')">Hunger</button>
      </div>

      <div id="snack-energy" class="tab-content">
        <p><strong>Energy snacks:</strong> bananas, nuts, yogurt.</p>
      </div>
      <div id="snack-focus" class="tab-content">
        <p><strong>Focus snacks:</strong> blueberries, dark chocolate (small), green tea.</p>
      </div>
      <div id="snack-stress" class="tab-content">
        <p><strong>Stress snacks:</strong> chamomile tea, almonds, fruit.</p>
      </div>
      <div id="snack-hunger" class="tab-content">
        <p><strong>Hunger snacks:</strong> hummus & veg, boiled egg, avocado toast.</p>
      </div>

      <img id="snack-img" src="" alt="Snack image" />
    </section>

    <!-- BMI -->
    <section>
      <h2>BMI Calculator</h2>
      <div class="flex">
        <div>
          <label for="bmi-age">Age</label>
          <input type="number" id="bmi-age" min="1" />
        </div>
        <div>
          <label for="bmi-height">Height (cm)</label>
          <input type="number" id="bmi-height" min="50" />
        </div>
        <div>
          <label for="bmi-weight">Weight (kg)</label>
          <input type="number" id="bmi-weight" min="20" />
        </div>
        <div style="align-self:flex-end;">
          <button onclick="calculateBMI()">Calculate BMI</button>
        </div>
      </div>

      <div class="bmi-display" id="bmi-display">0</div>
      <div class="bmi-bar">
        <div id="bmi-marker" class="bmi-marker" style="left:2%;"></div>
      </div>
      <div style="margin-top:8px;">
        <span id="bmi-status-tag" style="padding:6px 10px; border-radius:999px; background:#e6edf3; font-weight:700;">Status</span>
      </div>
      <div id="bmi-feedback" style="margin-top:8px; font-weight:600;"></div>
      <div id="risk-badge" style="margin-top:6px; font-weight:700;"></div>
    </section>

    <!-- BMR / TDEE -->
    <section>
      <h2>BMR & TDEE Calculator</h2>
      <div class="flex">
        <div>
          <label>Gender</label>
          <div style="display:flex; gap:8px; margin-top:6px;">
            <button id="btn-male" class="tab-btn" onclick="setGender('male')">Male</button>
            <button id="btn-female" class="tab-btn" onclick="setGender('female')">Female</button>
          </div>
        </div>
        <div>
          <label for="bmr-age">Age</label>
          <input type="number" id="bmr-age" min="1" />
        </div>
        <div>
          <label for="bmr-height">Height (cm)</label>
          <input type="number" id="bmr-height" min="50" />
        </div>
        <div>
          <label for="bmr-weight">Weight (kg)</label>
          <input type="number" id="bmr-weight" min="20" />
        </div>
        <div>
          <label for="formula">Formula</label>
          <select id="formula" onchange="calculateBMR()">
            <option value="mifflin">Mifflin-St Jeor</option>
            <option value="harris">Harris-Benedict</option>
          </select>
        </div>
        <div>
          <label for="activity">Activity</label>
          <select id="activity" onchange="calculateBMR()">
            <option value="1.2">Sedentary</option>
            <option value="1.375">Light</option>
            <option value="1.55">Moderate</option>
            <option value="1.725">Active</option>
            <option value="1.9">Very Active</option>
          </select>
        </div>
        <div style="align-self:flex-end;">
          <button onclick="calculateBMR()">Calculate</button>
        </div>
      </div>

      <div style="margin-top:12px;">
        <div><strong>BMR:</strong> <span id="bmr-result">0 kcal</span></div>
        <div><strong>TDEE:</strong> <span id="tdee-val">0 kcal</span></div>
        <div style="margin-top:6px;"><strong>Maintain:</strong> <span id="maintain-result">0 kcal</span> &nbsp; <strong>Lose (approx):</strong> <span id="loss-result">0 kcal</span></div>
      </div>
    </section>

    <!-- Simple Game -->
    <section>
      <h2>Catch the Healthy Food (30s)</h2>
      <div id="game-container">
        <div id="player-paddle">YOU</div>
        <div id="game-ui">
          <div id="score">0</div>
          <div style="display:flex; gap:8px;">
            <button onclick="startGame()">Start</button>
          </div>
        </div>
      </div>
      <audio id="game-bgm" src="" preload="auto"></audio>
    </section>

  </div>

  <script>
    /* Water calculator */
    function calculateWater() {
      const weightEl = document.getElementById('water-weight');
      if (!weightEl) return;
      const weight = parseFloat(weightEl.value) || 0;
      if (!weight) {
        document.getElementById('result-box').classList.add('hidden');
        return;
      }
      const liters = +(weight * 0.035).toFixed(1);
      const glasses = Math.round(liters * 4);
      document.getElementById('water-result').innerText = liters + ' Litres';
      document.getElementById('glass-count').innerText = glasses;
      document.getElementById('result-box').classList.remove('hidden');
    }

    /* Snack tabs */
    function showSnack(type) {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
      const target = document.getElementById('snack-' + type);
      if (target) target.classList.add('active');
      ['energy','focus','stress','hunger'].forEach(btn => {
        const el = document.getElementById('btn-' + btn);
        if (!el) return;
        if (btn === type) el.classList.add('active'); else el.classList.remove('active');
      });
      const images = {
        energy: 'https://images.unsplash.com/photo-1488477181946-6428a0291777?auto=format&fit=crop&q=80&w=800',
        focus: 'https://images.unsplash.com/photo-1596507724570-f8521ffc58ed?auto=format&fit=crop&q=80&w=800',
        stress: 'https://images.unsplash.com/photo-1623334042903-d44a7049448a?auto=format&fit=crop&q=80&w=800',
        hunger: 'https://images.unsplash.com/photo-1490818387583-1baba5e638af?auto=format&fit=crop&q=80&w=800'
      };
      const img = document.getElementById('snack-img');
      if (img && images[type]) img.src = images[type];
    }

    /* BMI calculator */
    function calculateBMI() {
      const age = parseFloat(document.getElementById('bmi-age').value) || 0;
      const heightCm = parseFloat(document.getElementById('bmi-height').value) || 0;
      const weight = parseFloat(document.getElementById('bmi-weight').value) || 0;
      if (!heightCm || !weight) return;
      const h = heightCm / 100;
      const bmi = +(weight / (h * h)).toFixed(1);
      document.getElementById('bmi-display').innerText = bmi;
      let status = '', color = '', risk = '', feedback = '';
      if (bmi < 18.5) { status='Underweight'; color='#0ea5e9'; risk='Low but increased risk'; feedback='Consider calorie-dense balanced diet.'; }
      else if (bmi < 23) { status='Normal'; color='#10b981'; risk='Optimal'; feedback='Maintain your current lifestyle.'; }
      else if (bmi < 27.5) { status='Pre-obese'; color='#f59e0b'; risk='Increased'; feedback='Monitor portions and activity.'; }
      else if (bmi < 32.5) { status='Obese I'; color='#fb923c'; risk='High'; feedback='Consider dietary adjustments.'; }
      else if (bmi < 37.5) { status='Obese II'; color='#ef4444'; risk='Very High'; feedback='Focus on weight management.'; }
      else { status='Obese III'; color='#b91c1c'; risk='Extremely High'; feedback='Seek medical advice.'; }
      const tag = document.getElementById('bmi-status-tag');
      tag.innerText = status;
      tag.style.background = '#f1f5f9';
      tag.style.color = color;
      document.getElementById('bmi-feedback').innerText = feedback;
      const pos = Math.min(95, Math.max(2, (bmi / 45) * 100));
      document.getElementById('bmi-marker').style.left = pos + '%';
      document.getElementById('risk-badge').innerText = 'Comorbidity Risk: ' + risk;
    }

    /* BMR / TDEE */
    let currentGender = 'male';
    function setGender(g) {
      currentGender = g;
      document.getElementById('btn-male').classList.toggle('active', g==='male');
      document.getElementById('btn-female').classList.toggle('active', g==='female');
      calculateBMR();
    }
    function calculateBMR() {
      const age = parseFloat(document.getElementById('bmr-age').value) || 0;
      const height = parseFloat(document.getElementById('bmr-height').value) || 0;
      const weight = parseFloat(document.getElementById('bmr-weight').value) || 0;
      const formula = document.getElementById('formula').value;
      const activity = parseFloat(document.getElementById('activity').value) || 1.2;
      if (!height || !weight) return;
      let bmr = 0;
      if (formula === 'mifflin') {
        if (currentGender === 'male') bmr = 10*weight + 6.25*height - 5*age + 5;
        else bmr = 10*weight + 6.25*height - 5*age - 161;
      } else {
        if (currentGender === 'male') bmr = 13.397*weight + 4.799*height - 5.677*age + 88.362;
        else bmr = 9.247*weight + 3.098*height - 4.330*age + 447.593;
      }
      if (bmr < 0) bmr = 0;
      const tdee = Math.round(bmr * activity);
      document.getElementById('bmr-result').innerText = Math.round(bmr) + ' kcal';
      document.getElementById('tdee-val').innerText = tdee + ' kcal';
      document.getElementById('loss-result').innerText = Math.max(0, tdee - 500) + ' kcal';
      document.getElementById('maintain-result').innerText = tdee + ' kcal';
    }

    /* Game logic */
    let gameActive = false, score = 0, paddlePos = 185;
    const container = document.getElementById('game-container');
    const bgm = document.getElementById('game-bgm');
    const scoreDisplay = document.getElementById('score');
    const ui = document.getElementById('game-ui');
    const goodItems = ['ðŸŽ','ðŸŒ','ðŸ¥œ','ðŸ¥¦','ðŸ‡','ðŸŠ','ðŸ“','ðŸ¥•','ðŸ’','ðŸ¥‘','ðŸ','ðŸ¥¬','ðŸ‰','ðŸ','ðŸ‹','ðŸ‘'];
    const badItems = ['ðŸ©','ðŸ”','ðŸŸ','ðŸ•','ðŸ«','ðŸª','ðŸ°','ðŸ¿','ðŸ—','ðŸŒ­','ðŸ','ðŸœ'];

    if (container) {
      container.addEventListener('mousemove', e => {
        const rect = container.getBoundingClientRect();
        let x = e.clientX - rect.left - 40;
        x = Math.max(0, Math.min(rect.width - 80, x));
        paddlePos = x;
        const paddle = document.getElementById('player-paddle');
        if (paddle) paddle.style.left = x + 'px';
      });
    }

    function spawnItem() {
      if (!gameActive || !container) return;
      const items = goodItems.concat(badItems);
      const char = items[Math.floor(Math.random()*items.length)];
      const el = document.createElement('div');
      el.className = 'item-drop';
      el.innerText = char;
      el.style.left = Math.random() * (container.clientWidth - 50) + 'px';
      el.style.top = '-50px';
      container.appendChild(el);
      let top = -50;
      const fall = setInterval(() => {
        if (!gameActive) { clearInterval(fall); el.remove(); return; }
        top += 6;
        el.style.top = top + 'px';
        const paddle = document.getElementById('player-paddle');
        if (paddle) {
          const pRect = paddle.getBoundingClientRect();
          const eRect = el.getBoundingClientRect();
          if (eRect.bottom >= pRect.top && eRect.left < pRect.right && eRect.right > pRect.left) {
            if (goodItems.includes(char)) score += 10; else score -= 15;
            scoreDisplay.innerText = score;
            clearInterval(fall);
            el.remove();
          }
        }
        if (top > container.clientHeight + 50) { clearInterval(fall); el.remove(); }
      }, 20);
    }

    function startGame() {
      if (gameActive) return;
      gameActive = true; score = 0; scoreDisplay.innerText = 0;
      if (ui) ui.style.display = 'none';
      if (bgm) { try { bgm.currentTime = 0; bgm.volume = 0.5; bgm.play(); } catch(e) {} }
      const sp = setInterval(()=> { if (!gameActive) clearInterval(sp); else spawnItem(); }, 800);
      setTimeout(()=> {
        gameActive = false;
        if (bgm) try { bgm.pause(); } catch(e) {}
        if (ui) ui.style.display = 'flex';
        document.querySelectorAll('.item-drop').forEach(x=>x.remove());
      }, 30000);
    }

    /* Init */
    window.onload = () => {
      // sensible defaults
      document.getElementById('water-weight').value = '';
      showSnack('energy');
      calculateWater();
      calculateBMI();
      calculateBMR();
      // set default gender button style
      setGender('male');
    };
  </script>
</body>
</html>











